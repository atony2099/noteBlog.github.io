<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="托尼的开发笔记">
<meta property="og:url" content="atony2099.github.io/page/5/index.html">
<meta property="og:site_name" content="托尼的开发笔记">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="托尼的开发笔记">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="atony2099.github.io/page/5/"/>





  <title> 托尼的开发笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">托尼的开发笔记</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/06/12/OC语法/property/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/12/OC语法/property/" itemprop="url">
                  property
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-12T22:27:40+08:00">
                2016-06
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h4><p>封装实例变量，生成存取方法,由编译器自动合成</p>
<p>property = var+ setter + getter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@interface Person : NSObject</span><br><span class="line">@property NSString *name;</span><br><span class="line">@property NSString *lastName;</span><br><span class="line">@end</span><br><span class="line">//----等价于</span><br><span class="line">@interface Person : NSObject</span><br><span class="line">- (NSString *)name;</span><br><span class="line">- (void)setName:(NSString *)name;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h4 id="生成关键字种类"><a href="#生成关键字种类" class="headerlink" title="生成关键字种类"></a>生成关键字种类</h4><ul>
<li><p>内存管理</p>
<p>assign, weak,strong,copy</p>
<p>​</p>
</li>
</ul>
<ul>
<li><p>线程安全</p>
<blockquote>
<p>atomic: 加锁， 多线程安全(安全), nonatomic:不加锁</p>
<p>相关伪代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; - (void)setProp:(NSString *)newValue &#123;</span><br><span class="line">&gt;     [_prop lock];</span><br><span class="line">&gt;     _prop = newValue;</span><br><span class="line">&gt;     [_prop unlock];</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>atomic 只能保证读写操作的完整性，但是并不能保证线程安全</p>
<p>试想一下这个例子</p>
<p>线程A 和线程B同时对X进行写入操作。</p>
<p>当线程A进行写操作，这时其他线程的读或者写操作会因为该操作而等待。当A线程的写操作结束后，B线程进行写操作，然后当A线程需要读操作时，却获得了在B线程中的值，这就破坏了线程安全。</p>
<p>Thread A:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; p.firstName = @&quot;Rob&quot;;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>Thread B:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; p.firstName = @&quot;Robert&quot;;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>Thread A:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; label.string = p.firstName;   // &lt;&lt; uh, oh -- will be Robert</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>​</p>
</li>
<li><p>读写</p>
<p>readwrite, readonly</p>
<blockquote>
<p>readonly 不合成setter方法</p>
</blockquote>
</li>
<li><p>命名</p>
<p>for: </p>
<p><code>@property (nonatomic, assign, getter = isOpen) BOOL open;</code></p>
<p>setter的修改方式类似，只是不太常用</p>
</li>
</ul>
<p>参考:</p>
<p><a href="http://stackoverflow.com/questions/12347236/which-is-threadsafe-atomic-or-non-atomic" target="_blank" rel="external">Which is threadsafe atomic or non atomic?</a></p>
<p><a href="http://blog.talisk.cn/blog/2016/03/05/iOS-@property/" target="_blank" rel="external">@property的前世今生</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/21/RAC大法好/MVVM/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/21/RAC大法好/MVVM/" itemprop="url">
                  幸存者偏差
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-21T14:18:27+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="幸存者偏差"><a href="#幸存者偏差" class="headerlink" title="幸存者偏差"></a>幸存者偏差</h4><blockquote>
<p>幸存者偏差，<strong>只能看到某种筛选的结果而没有意识到筛选的过程，从而忽略了被筛选掉的关键信息</strong></p>
<ol>
<li>一名记者来到火车站台上，随机询问：“请问你买到火车票了吗？” </li>
</ol>
<p>一位大妈微微一愣，回答：“买到了” </p>
<p>记者又转向一位精瘦精瘦的年轻人，问：“请问你买到火车票了吗？”<br>年轻人回答：“买到了” </p>
<p>随后记者又问了5个人，大家都回答：“买到了” </p>
<p>最后记者对着镜头说：“今年虽然火车票难买，但是通过采访我们发现，大家都买到了火车票，现在正满怀希望地赶回家乡，过个团圆年！</p>
<ol>
<li>创业。新闻媒体只会报道活下来的企业，你一看全世界都是创业成功的企业，于是被坑进去了.</li>
</ol>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/11/性能优化/离屏渲染/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/11/性能优化/离屏渲染/" itemprop="url">
                  离屏渲染
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-11T23:38:06+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="什么是离屏渲染"><a href="#什么是离屏渲染" class="headerlink" title="什么是离屏渲染"></a>什么是离屏渲染</h4><blockquote>
<p>off-Screen Rendering,在当前屏幕缓冲区新开一个缓冲区进行操作</p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-20/65044499-file_1484920235247_94fc.png" alt=""></p>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-20/49773130-file_1484920235096_dcca.png" alt=""></p>
<p> 正常情况下，GPU在当前屏幕的缓冲区进行渲染就可以了</p>
<p>对于比较复杂图形，要开辟新的缓冲区，分通道进行渲染，最后才合并</p>
<p>具体包括以下情况</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/RAC大法好/reactive-cocoa学习笔记/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/RAC大法好/reactive-cocoa学习笔记/" itemprop="url">
                  reactive cocoa学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T08:00:00+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://mrpeak.cn/blog/functional/" target="_blank" rel="external">iOS与函数式编程</a></p>
<p><a href="https://gold.xitu.io/post/583907a961ff4b006cafce82" target="_blank" rel="external">ReactiveCocoa 中 RACSignal 所有变换操作底层实现分析(上)</a></p>
<p><a href="http://mcxiaoke.gitbooks.io/rxdocs/content/" target="_blank" rel="external">ReactiveX/RxJava文档中文版</a></p>
<p><a href="http://tech.meituan.com/RACSignalSubscription.html" target="_blank" rel="external">RACSignal的Subscription深入分析</a></p>
<h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><h5 id="side-effects-副作用"><a href="#side-effects-副作用" class="headerlink" title="side effects(副作用)"></a>side effects(副作用)</h5><blockquote>
<p> In <a href="https://en.wikipedia.org/wiki/Computer_science" target="_blank" rel="external">computer science</a>, a <a href="https://en.wikipedia.org/wiki/Subroutine" target="_blank" rel="external">function</a> or <a href="https://en.wikipedia.org/wiki/Expression_(programming" target="_blank" rel="external">expression</a>) is said to have a <strong>side effect</strong> if it modifies some <a href="https://en.wikipedia.org/wiki/State_(computer_science" target="_blank" rel="external">state</a>) outside its scope or has an <em>observable</em> interaction with its calling functions or the outside world</p>
<p> For example, a particular function might modify a <a href="https://en.wikipedia.org/wiki/Global_variable" target="_blank" rel="external">global variable</a> or <a href="https://en.wikipedia.org/wiki/Static_variable" target="_blank" rel="external">static variable</a>, modify one of its arguments, raise an exception, write data to a display or file, read data, or call other side-effecting functions.</p>
<p> 简单理解: 一个函数的影响应控制在它的作用域内，它在执行过程中不应该依赖外部或者对外部产生影响</p>
<p> 常见的副作用</p>
<ol>
<li>影响了外部变量，比如全局变量</li>
<li>函数执行过程中依赖外部变量</li>
<li>其他外部影响:函数执行中，log出信息，写入了文件，触发了网络请求，更新了屏幕</li>
</ol>
</blockquote>
<h5 id="referential-transparency-引用透明"><a href="#referential-transparency-引用透明" class="headerlink" title="referential transparency(引用透明)"></a>referential transparency(引用透明)</h5><blockquote>
<p><a href="http://stackoverflow.com/questions/210835/what-is-referential-transparency" target="_blank" rel="external">What is referential transparency?</a></p>
<p>Referential transparency, a term commonly used in functional programming, means that given a function and an input value, you will always receive the same output. That is to say there is no external state used in the function.</p>
<p>Here is an example of a referential transparent function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; int plusOne(int x)</span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;   return x+1;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>With a referential transparent function, given an input and a function, you could replace it with a value instead of calling the function. So instead of calling plusOne with a paremter of 5, we could just replace that with 6.</p>
<p>Another good example is mathematics in general. In mathematics given a function and an input value, it will always map to the same output value. f(x) = x + 1. Therefore functions in mathematics are referentially transparent.</p>
<ul>
<li><p>简单理解: 引用透明，函数输入相同参数总是得到相同的结果.</p>
<p>func(A) = 5, func(A)可以用5来代替</p>
</li>
</ul>
</blockquote>
<h5 id="pure-function"><a href="#pure-function" class="headerlink" title="pure function"></a>pure function</h5><blockquote>
<p> <strong>a pure function is referentially transparent and has no side effects</strong></p>
<p>纯函数是具备引用透明 和没有副作用的函数</p>
</blockquote>
<h5 id="First-Class"><a href="#First-Class" class="headerlink" title="First Class"></a>First Class</h5><blockquote>
<p>函数: 普通公民 </p>
<p>变量:一等公民</p>
<p>函数编程的一等公民: 函数可以像变量那样自由传递(当做参数或者返回值)</p>
<p>RACStream //抽象类</p>
<ul>
<li>RACSignal  </li>
<li>RACSubject // A subject can be thought of as a signal that you can manually control by sending next, completed, and error.</li>
</ul>
</blockquote>
<h4 id="信号的理解"><a href="#信号的理解" class="headerlink" title="信号的理解"></a>信号的理解</h4><p>reactive cocoa 主要操作的是信号。</p>
<blockquote>
<p> <strong>信号</strong>:可以把信号想象成水龙头，只不过里面不是水，而是玻璃球(value)，直径跟水管的内径一样，这样就能保证玻璃球是依次排列，不会出现并排的情况(数据都是线性处理的，不会出现并发情况)。水龙头的开关默认是关的，除非有了接收方(subscriber)，才会打开。这样只要有新的玻璃球进来，就会自动传送给接收方。可以在水龙头上加一个过滤嘴(filter)，不符合的不让通过，也可以加一个改动装置，把球改变成符合自己的需求(map)。也可以把多个水龙头合并成一个新的水龙头(combineLatest:reduce:)，这样只要其中的一个水龙头有玻璃球出来，这个新合并的水龙头就会得到这个球。</p>
</blockquote>
<h4 id="信号的基本操作"><a href="#信号的基本操作" class="headerlink" title="信号的基本操作"></a>信号的基本操作</h4><h5 id="过滤操作"><a href="#过滤操作" class="headerlink" title="过滤操作"></a>过滤操作</h5><h6 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h6><p>Maps <code>block</code> across the values in the receiver.</p>
<h6 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h6><p>Filters out values in the receiver that don’t pass the given test.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">   RACSignal *signalP= [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">       </span><br><span class="line">       [subscriber sendNext:@1];</span><br><span class="line">       [subscriber sendNext:@2];</span><br><span class="line">       [subscriber sendCompleted];</span><br><span class="line">       </span><br><span class="line">       return [RACDisposable disposableWithBlock:^&#123;</span><br><span class="line">           NSLog(@&quot;dispose&quot;);</span><br><span class="line">       &#125;];</span><br><span class="line">   &#125;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   RACSignal *signalN = [signalP map:^id(NSNumber *value) &#123;</span><br><span class="line">       return @([value intValue] +1);</span><br><span class="line">   &#125;];</span><br><span class="line"></span><br><span class="line">RACSignal *signalG = [signalP filter:^BOOL(NSNumber *value) &#123;</span><br><span class="line">      </span><br><span class="line">       return [value intValue] &gt; 1;</span><br><span class="line">   &#125;];</span><br><span class="line">   // output: 2,3</span><br><span class="line">   [signalN subscribeNext:^(id x) &#123;</span><br><span class="line">       NSLog(@&quot;%@&quot;,x);</span><br><span class="line">   &#125;];</span><br><span class="line">// output:2</span><br><span class="line">   [signalG subscribeNext:^(id x) &#123;</span><br><span class="line">       NSLog(@&quot;%@&quot;,x);</span><br><span class="line">   &#125;];</span><br></pre></td></tr></table></figure>
<h6 id="throttle"><a href="#throttle" class="headerlink" title="throttle"></a>throttle</h6><p>指定时间内，产生A信号，紧接着产生B信号，这时候A信号就会被抛弃，</p>
<p>如果在指定时间内，再也没有产生新信号，则B信号会一直保留知道指定时间到达</p>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-23/23396068-file_1485141818101_8d8f.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber)&#123;</span><br><span class="line">    [subscriber sendNext:@&quot;🐹1&quot;];</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [subscriber sendNext:@&quot;🐹2&quot;];</span><br><span class="line">    &#125;);</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [subscriber sendNext:@&quot;🐹3&quot;];</span><br><span class="line">        [subscriber sendNext:@&quot;🐹4&quot;];</span><br><span class="line">        [subscriber sendNext:@&quot;🐹5&quot;];</span><br><span class="line">    &#125;);</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(3 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [subscriber sendNext:@&quot;🐹6&quot;];</span><br><span class="line">    &#125;);</span><br><span class="line">    return nil;</span><br><span class="line">&#125;] throttle:10] subscribeNext:^(id x) &#123;</span><br><span class="line">    NSLog(@&quot;%@通过了&quot;,x);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h5 id="distinctUntilChanged"><a href="#distinctUntilChanged" class="headerlink" title="distinctUntilChanged"></a>distinctUntilChanged</h5><p><img src="https://mcxiaoke.gitbooks.io/rxdocs/content/im&gt; ages/operators/distinctUntilChanged.png" alt=""></p>
<p>与前驱值不同过滤掉</p>
<h6 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h6><h6 id="take"><a href="#take" class="headerlink" title="take"></a>take</h6><h4 id="多个信号的组合操作"><a href="#多个信号的组合操作" class="headerlink" title="多个信号的组合操作"></a>多个信号的组合操作</h4><p>关注的问题: </p>
<ul>
<li>受那个信号终止而终止</li>
<li>错误传递</li>
<li>各个信号何时开始订阅</li>
</ul>
<h5 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h5><p><img src="http://ohbzayk4i.bkt.clouddn.com/Jietu20170122-191924.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  RACSignal *singalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">      [subscriber sendNext:@1];</span><br><span class="line">       [subscriber sendCompleted];</span><br><span class="line">      return nil;</span><br><span class="line">   &#125;];</span><br><span class="line">   RACSignal *singalB= [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span><br><span class="line">       [subscriber sendNext:@2];</span><br><span class="line">       [subscriber sendCompleted];</span><br><span class="line">       return nil;</span><br><span class="line">   &#125;];</span><br><span class="line">   </span><br><span class="line">   RACSignal *singalC = [singalA concat:singalB];</span><br><span class="line"></span><br><span class="line">// OUTPUT : 1,2,</span><br><span class="line">   [singalC subscribeNext:^(id x) &#123;</span><br><span class="line">       NSLog(@&quot;%@&quot;,x);</span><br><span class="line">   &#125;];</span><br></pre></td></tr></table></figure>
<p>关键点: 必须等待第一个信号结束。</p>
<h5 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h5><p><img src="http://ohbzayk4i.bkt.clouddn.com/Jietu20170123-025345.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RACSubject *subject1 = [RACSubject subject];</span><br><span class="line">RACSubject *subject2 = [RACSubject subject];</span><br><span class="line">RACSignal *signal =  [RACSignal merge:@[subject1, subject2]];</span><br><span class="line">// OUTPUT : 1,2,3,4</span><br><span class="line">[signal subscribeNext:^(id x) &#123;</span><br><span class="line">    NSLog(@&quot;%@&quot;,x);</span><br><span class="line">&#125;];</span><br><span class="line">[subject1 sendNext:@1];</span><br><span class="line">[subject2 sendNext:@2];</span><br><span class="line">[subject1 sendNext:@3];</span><br><span class="line">[subject2 sendNext:@4];</span><br></pre></td></tr></table></figure>
<p>关键点:哪个先到输出哪个</p>
<h4 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h4><blockquote>
<p>The first value of each stream will be combined, then the second value, and so forth, until at least one of the streams is exhausted. <strong>它按照严格的顺序组合信号，只有当原始的Observable中的每一个都发射了一条数据时<code>zip</code>才发射数据,想象成拉链，一环扣一环</strong></p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/Jietu20170123-040639.jpg" alt=""></p>
<h4 id="combineLatest"><a href="#combineLatest" class="headerlink" title="combineLatest"></a>combineLatest</h4><p>组合的数值总是保持最新的</p>
<blockquote>
<p>当原始Observables的任何一个发射了一条数据时，<code>CombineLatest</code>使用一个函数结合它们最近发射的数据，然后发射这个函数的返回值</p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/Snip20170123_1.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">RACSubject *subject1 = [RACSubject subject];</span><br><span class="line">RACSubject *subject2 = [RACSubject subject];</span><br><span class="line">RACSignal *signal =  [RACSignal combineLatest:@[subject1, subject2]];</span><br><span class="line"></span><br><span class="line">// output: ractuple(1,11), ractuple(1,2),ractuple(3,11), ractuple3,4),</span><br><span class="line">[signal subscribeNext:^(id x) &#123;</span><br><span class="line">    NSLog(@&quot;%@&quot;,x);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[subject1 sendNext:@1];</span><br><span class="line">[subject2 sendNext:@11];</span><br><span class="line">[subject2 sendNext:@2];</span><br><span class="line">[subject1 sendNext:@3];</span><br><span class="line">[subject2 sendNext:@4];</span><br></pre></td></tr></table></figure>
<h4 id="高阶信号的操作"><a href="#高阶信号的操作" class="headerlink" title="高阶信号的操作"></a>高阶信号的操作</h4><p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-23/55592449-file_1485132732496_ef3a.png" alt=""></p>
<p>[1,2,3,[3,4],5] </p>
<p>数组的数组: 数组里面是数组</p>
<p>高阶信号: 信号流里面还是信号。</p>
<h5 id="降阶操作"><a href="#降阶操作" class="headerlink" title="降阶操作"></a>降阶操作</h5><h6 id="Switchtolasts"><a href="#Switchtolasts" class="headerlink" title="Switchtolasts"></a>Switchtolasts</h6><blockquote>
<p>关键点:新的信号开始被订阅时候，前一个信号会被取消订阅。</p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-23/77510402-file_1485133672444_3a17.png" alt=""></p>
<h6 id="Flatten"><a href="#Flatten" class="headerlink" title="Flatten"></a>Flatten</h6><blockquote>
<p>关键点: 各个信号都会被降解，不会被取消</p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/17-1-24/53245742-file_1485258981093_15afe.png" alt=""></p>
<h4 id="订阅过程简析"><a href="#订阅过程简析" class="headerlink" title="订阅过程简析"></a>订阅过程简析</h4><h6 id="步骤一：-RACSignal-createSignal-来获得signal"><a href="#步骤一：-RACSignal-createSignal-来获得signal" class="headerlink" title="步骤一：[RACSignal createSignal]来获得signal"></a>步骤一：[RACSignal createSignal]来获得signal</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">RACSignal.m中：</span><br><span class="line">+ ( RACSignal *)createSignal:( RACDisposable * (^)( id &lt; RACSubscriber &gt; subscriber))didSubscribe &#123;</span><br><span class="line">  return [ RACDynamicSignal   createSignal :didSubscribe];</span><br><span class="line">&#125;</span><br><span class="line">RACDynamicSignal.m中</span><br><span class="line">+ ( RACSignal *)createSignal:( RACDisposable * (^)( id &lt; RACSubscriber &gt; subscriber))didSubscribe &#123;</span><br><span class="line">  RACDynamicSignal *signal = [[ self   alloc ] init ];</span><br><span class="line"> signal-&gt; _didSubscribe = [didSubscribe copy ];</span><br><span class="line">  return [signal setNameWithFormat : @&quot;+createSignal:&quot; ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>[RACSignal createSignal]会调用子类RACDynamicSignal的createSignal来返回一个signal，</p>
<p>并在signal中保存后面的 didSubscribe这个block</p>
<h6 id="步骤二：-signal-subscribeNext-来获得subscriber，然后进行subscription"><a href="#步骤二：-signal-subscribeNext-来获得subscriber，然后进行subscription" class="headerlink" title="步骤二：[signal subscribeNext:]来获得subscriber，然后进行subscription"></a>步骤二：[signal subscribeNext:]来获得subscriber，然后进行subscription</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">RACSignal.m中：</span><br><span class="line">- ( RACDisposable *)subscribeNext:( void (^)( id x))nextBlock &#123;</span><br><span class="line">  RACSubscriber *o = [ RACSubscriber   subscriberWithNext :nextBlock error : NULL   completed : NULL ];</span><br><span class="line">  return [ self  subscribe :o];</span><br><span class="line">&#125;</span><br><span class="line">RACSubscriber.m中：</span><br><span class="line"></span><br><span class="line">+ ( instancetype )subscriberWithNext:( void (^)( id x))next error:( void (^)( NSError *error))error completed:( void (^)( void ))completed &#123;</span><br><span class="line">  RACSubscriber *subscriber = [[ self   alloc ] init ];</span><br><span class="line"> subscriber-&gt; _next = [next copy ];</span><br><span class="line"> subscriber-&gt; _error = [error copy ];</span><br><span class="line"> subscriber-&gt; _completed = [completed copy ];</span><br><span class="line">  return subscriber;</span><br><span class="line">&#125;</span><br><span class="line">RACDynamicSignal.m中：</span><br><span class="line">- (RACDisposable *)subscribe:(id&lt;RACSubscriber&gt;)subscriber &#123;</span><br><span class="line">    RACCompoundDisposable *disposable = [RACCompoundDisposable compoundDisposable];</span><br><span class="line">    subscriber = [[RACPassthroughSubscriber alloc] initWithSubscriber:subscriber signal:self disposable:disposable];</span><br><span class="line">    if (self.didSubscribe != NULL) &#123;</span><br><span class="line">        RACDisposable *schedulingDisposable = [RACScheduler.subscriptionScheduler schedule:^&#123;</span><br><span class="line">          	// 入参</span><br><span class="line">            RACDisposable *innerDisposable = self.didSubscribe(subscriber);</span><br><span class="line">            [disposable addDisposable:innerDisposable];</span><br><span class="line">        &#125;];</span><br><span class="line">        [disposable addDisposable:schedulingDisposable];</span><br><span class="line">    &#125;</span><br><span class="line">    return disposable;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>[signal subscribeNext]先会获得一个subscriber，这个subscriber中保存了nextBlock、errorBlock、completedBlock</li>
<li>由于signal其实是RACDynamicSignal类型的，这个[self subscribe]方法会调用步骤一中保存的didSubscribe，didSubscribe的参数就是1中的subscriber</li>
</ol>
<h6 id="步骤三：进入didSubscribe，通过-subscriber-sendNext-来执行next-block"><a href="#步骤三：进入didSubscribe，通过-subscriber-sendNext-来执行next-block" class="headerlink" title="步骤三：进入didSubscribe，通过[subscriber sendNext:]来执行next block"></a>步骤三：进入didSubscribe，通过[subscriber sendNext:]来执行next block</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RACSubscriber.m中：</span><br><span class="line">- (void)sendNext:(id)value &#123;</span><br><span class="line">    @synchronized (self) &#123;</span><br><span class="line">        void (^nextBlock)(id) = [self.next copy];</span><br><span class="line">        if (nextBlock == nil) return;</span><br><span class="line">        nextBlock(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>didsubiscribeblock的[subscriber send:@1] 的实际执行者就是上一步的那个subscriber</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-protocol/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-protocol/" itemprop="url">
                  swift protocol
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-tips/as/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-tips/as/" itemprop="url">
                  swift protocol
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>as , as!, as?</p>
<p>The as keyword used to do both upcasts and downcasts:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before Swift 1.2</span></span><br><span class="line"><span class="keyword">var</span> aView: <span class="type">UIView</span> = someView()</span><br><span class="line"><span class="keyword">var</span> object = aView <span class="keyword">as</span> <span class="type">NSObject</span> <span class="comment">// upcast </span></span><br><span class="line"><span class="keyword">var</span> specificView = aView <span class="keyword">as</span> <span class="type">UITableView</span> <span class="comment">// downcast</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">The upcast, going from a derived class to a base class, can be checked at compile time and will never fail.</span><br><span class="line"></span><br><span class="line">However, downcasts can fail since you can’t always be sure about the specific class. If you have a UIView, it’s possible it’s a UITableView or maybe a UIButton. If your downcast goes to the correct type – great! But if you happen to specify the wrong type, you’ll get a runtime error and the app will crash.</span><br><span class="line"></span><br><span class="line">In Swift 1.2, downcasts must be either optional with as? or “forced failable” with as!. If you’re sure about the type, then you can force the cast with as! similar to how you would use an implicitly-unwrapped optional:</span><br></pre></td></tr></table></figure>
<p>// After Swift 1.2<br>var aView: UIView = someView()</p>
<p>var tableView = aView as! UITableView<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">The exclamation point makes it absolutely clear that you know what you’re doing and that there’s a chance things will go terribly wrong if you’ve accidentally mixed up your types!</span><br><span class="line"></span><br><span class="line">As always, as? with optional binding is the safest way to go:</span><br><span class="line"></span><br><span class="line">```swift</span><br><span class="line">// This isn&apos;t new to Swift 1.2, but is still the safest way</span><br><span class="line">var aView: UIView = someView()</span><br><span class="line"></span><br><span class="line">if let tableView = aView as? UITableView &#123;</span><br><span class="line">  // do something with tableView</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>(<a href="http://stackoverflow.com/questions/29637974/whats-the-difference-between-as-as-and-as" target="_blank" rel="external">What’s the difference between “as?”, “as!”, and “as”?</a>)[<a href="http://stackoverflow.com/questions/29637974/whats-the-difference-between-as-as-and-as" target="_blank" rel="external">http://stackoverflow.com/questions/29637974/whats-the-difference-between-as-as-and-as</a>]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-tips/访问权限控制/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-tips/访问权限控制/" itemprop="url">
                  访问级别控制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="原有访问级别"><a href="#原有访问级别" class="headerlink" title="原有访问级别"></a>原有访问级别</h4><ol>
<li>公开(public)</li>
<li>内部(internal)</li>
<li>私有(private)</li>
</ol>
<blockquote>
<p>默认的访问级别是 <code>internal</code>，这意味着此成员只能在模组 (module) 内可见。如果要让其能够被模组外的成员访问到的话，那么就要将其设置为 <code>public</code>。</p>
</blockquote>
<h4 id="private-到-fileprivate"><a href="#private-到-fileprivate" class="headerlink" title="private 到 fileprivate"></a>private 到 fileprivate</h4><p>fileprivate:同一个文件内可见</p>
<p>private:只能在对应作用域内访问</p>
<blockquote>
<p>举个例子，在这个文件当中我创建了一个类。在这个类当中我添加了一个 <code>private</code> 的属性和一个 <code>private</code> 的方法。这两个成员只能够在这个类当中可见，就算位于相同文件内，其他类也是无法访问这两个成员的。因此，也就是说，在过去，这两个成员在整个文件当中都可以访问得到；而到了现在，<code>private</code> 方法只能够在相同类当中可见了。也就是说，昔日的 <code>private</code> 变成了今日的 <code>fileprivate</code>，而新的访问级别让我们有了更私有的访问权限。</p>
</blockquote>
<h4 id="public-到-open"><a href="#public-到-open" class="headerlink" title="public 到 open"></a>public 到 open</h4><p>open:一个元素在其他module中是可以被访问并且可以被override</p>
<p>public: 一个元素在其他module只能被访问无法被继承</p>
<blockquote>
<p>open解决问题: 继承是一件危险的事情。尤其对于一个framework或者module的设计者而言。在自身的module内，类或者属性对于作者而言是清晰的，能否被继承或者override都是可控的。但是对于使用它的人，作者有时会希望传达出这个类或者属性不应该被继承或者修改。</p>
</blockquote>
<h4 id="新的访问级别"><a href="#新的访问级别" class="headerlink" title="新的访问级别"></a>新的访问级别</h4><ol>
<li>完全公开(open)</li>
<li>公开（public）</li>
<li>内部(internal)</li>
<li>文件外私有(fileprivate)</li>
<li>私有(private)</li>
</ol>
<p><a href="http://www.jianshu.com/p/604305a61e57" target="_blank" rel="external">Swift 3必看：新的访问控制fileprivate和open</a></p>
<p><a href="https://realm.io/cn/news/appbuilders-daniel-steinberg-whats-new-swift-3/" target="_blank" rel="external">Swift 3 新特性一览</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-tips/escaping/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-tips/escaping/" itemprop="url">
                  访问级别控制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-Escaping-Closure"><a href="#1-Escaping-Closure" class="headerlink" title="1.Escaping Closure"></a>1.Escaping Closure</h4><blockquote>
<p> 一个闭包作为一个参数传递给一个函数，并且在函数return之后才被唤起执行</p>
</blockquote>
<p><img src="http://ohbzayk4i.bkt.clouddn.com/16-12-24/50262357-file_1482564200621_e595.png" alt=""></p>
<p>什么情况下会引起逃逸？</p>
<blockquote>
<ol>
<li>Asynchronous execution: If you execute the closure asynchronously on a dispatch queue, the queue will hold onto the closure for you. You have no idea <em>when</em> the closure will be executed and there’s no guarantee it will complete before the function returns.</li>
<li>Storage: Storing the closure to a global variable, property, or any other bit of storage that lives on past the function call means the closure has also escaped</li>
</ol>
</blockquote>
<p>swift3闭包默认是非逃逸，逃逸闭包需要加上@escaping标记</p>
<p>默认非逃逸的好处: </p>
<ol>
<li>最明显的好处就是编译器优化你的代码的性能和能力。如果编译器知道这个闭包是不可逃逸的，它可以关注内存管理的关键细节。</li>
<li>可以在不可逃逸闭包里放心的使用self关键字，因为这个闭包总是在函数return之前执行，你不需要去使用一个弱引用去引用self.</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-tips/anyobject/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-tips/anyobject/" itemprop="url">
                  swift protocol
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h4><p>anyObject:Any 可以代表 struct、class、func 等等几乎所有类型</p>
<p>any : class实例</p>
<blockquote>
<p><code>AnyObject</code>是<code>Any</code>的子集</p>
</blockquote>
<p>swift 2</p>
<blockquote>
<p>那为什么之前我们在 Swift 2  里可以用 [AnyObject] 声明数组，并且在里面放 Int、String 等 struct 类型呢？这是因为 Swift 2 中，会针对这些 Int、String 等 struct 进行一个 Implicit Bridging Conversions，在 Array 里插入他们时，编译器会自动将其 bridge 到 Objective-C 的 NSNumber、NSString 等类型，这就是为什么我们声明的 [AnyObject] 里可以放 struct 的原因。</p>
</blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/22584349" target="_blank" rel="external">适配 Swift 3 的一点小经验和坑</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="atony2099.github.io/2016/05/01/swift-tips/swift-init/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="tony2009">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="托尼的开发笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="托尼的开发笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/01/swift-tips/swift-init/" itemprop="url">
                  init方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-01T00:22:12+08:00">
                2016-05
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://wiki.jikexueyuan.com/project/swift/chapter2/14_Initialization.html" target="_blank" rel="external">构造过程</a></p>
<ul>
<li>init </li>
</ul>
<p>构造过程: 使用类，结构体，的实例之前的准备过程，</p>
<ol>
<li>设置实例变量的初始值。</li>
<li>其他一些初始化工作</li>
</ol>
<p>规则: </p>
<ul>
<li>指定构造器必须总是<em>向上</em>代理</li>
<li>便利构造器必须总是<em>横向</em>代理指定构造器调用父亲指定构造器</li>
</ul>
<h4 id="两段式构造过程"><a href="#两段式构造过程" class="headerlink" title="两段式构造过程"></a>两段式构造过程</h4><ol>
<li><p>每个存储属性指定一个初始值</p>
</li>
<li><p>进一步定制存储属性</p>
<blockquote>
<p>vs object-c: object-c帮我们指定了初始值(nil 或者 0)</p>
</blockquote>
</li>
</ol>
<h4 id="构造函数的重载-重写"><a href="#构造函数的重载-重写" class="headerlink" title="构造函数的重载,重写"></a>构造函数的重载,重写</h4><p>重载: overload: 参数列表: 不一样，返回列表： 无所谓</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; 一旦重载构造函数  默认的构造函数就不能访问</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>重写 override :参数列表和返回类型一致</p>
<h4 id="构造器的继承"><a href="#构造器的继承" class="headerlink" title="构造器的继承:"></a>构造器的继承:</h4><p>子类默认情况下不会继承父类的构造器</p>
<p>1.如果子类没有定义任何指定构造器，它将自动继承父类的指定构造器</p>
<ol>
<li>如果子类提供了所有父类指定构造器的实现——无论是通过规则 1 继承过来的，还是提供了自定义实现——它将自动继承所有父类的便利构造器。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line"></span><br><span class="line">class wheel: UIControl &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But this code doesn’t:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class wheel: UIControl &#123;</span><br><span class="line">override init(frame: CGRect) &#123;</span><br><span class="line">    super.init(frame: frame)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It shows error “<em>required initializer init must be provided in subclass of UIControl</em>“ when I override init(frame: CGRect) but not init(coder aDecoder: NSCoder)</p>
<p>Look. According to <a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Initialization.html" target="_blank" rel="external">Apple documentations</a> Swift subclasses do not inherit their superclass initializers by default. They are inherited only in certain circumstances, one of which is: If your subclass doesn’t define any designated initializers, it automatically inherits all of its superclass designated initializers. So if you’re not implementing <code>init(frame: CGRect)</code> all super initializers are inherited.</p>
<p>Also UIView adopts NSCoding protocol, which requires an <code>init(coder:)</code> initializer. So if you’re implementing <code>init(frame: CGRect)</code>, your class is no longer inheriting super initializers. So you must implement that one too:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">required</span> <span class="keyword">init</span>?(coder decoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>?(coder: decoder)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="可失败的构造器"><a href="#可失败的构造器" class="headerlink" title="可失败的构造器"></a>可失败的构造器</h4><p>如果一个类、结构体或枚举类型的对象，在构造过程中有可能失败，则为其定义一个可失败构造器。这里所指的“失败”是指，如给构造器传入无效的参数值，或缺少某种所需的外部资源，又或是不满足某种必要的条件等。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> species: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>?(species: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> species.isEmpty &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">self</span>.species = species</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="tony2009" />
          <p class="site-author-name" itemprop="name">tony2009</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">83</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tony2009</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  




  
  

  

  

  

  


</body>
</html>
